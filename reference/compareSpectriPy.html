<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spectra similarity calculations using Python's matchms library — compareSpectriPy • SpectriPy</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spectra similarity calculations using Python's matchms library — compareSpectriPy"><meta name="description" content="The compareSpectriPy() function allows to calculate spectral similarity
scores using the calculate_scores() function of the Python
matchms.similarity.
module.
Selection and configuration of the algorithm can be performed with one of the
parameter objects/functions:
CosineGreedy(): calculate the cosine similarity score between
spectra. The score is calculated by finding the best possible matches
between peaks of two spectra. Two peaks are considered a potential match if
their m/z ratios lie within the given tolerance. The underlying peak
assignment problem is here solved in a greedy way. This can perform
notably faster, but does occasionally deviate slightly from a fully correct
solution (as with the CosineHungarian algorithm). In practice this
will rarely affect similarity scores notably, in particular for smaller
tolerances. The algorithm can be configured with parameters tolerance,
mz_power and intensity_power (see parameter description for more
details). See also
matchms CosineGreedy for more information.
CosineHungarian(): calculate the cosine similarity score as with
CosineGreedy, but using the Hungarian algorithm to find the best
matching peaks between the compared spectra. The algorithm can be
configured with parameters tolerance, mz_power and intensity_power
(see parameter description for more details). See also
matchms CosingHungarian for more information.
ModifiedCosine(): The modified cosine score aims at quantifying the
similarity between two mass spectra. The score is calculated by finding
the best possible matches between peaks of two spectra. Two peaks are
considered a potential match if their m/z ratios lie within the given
tolerance, or if their m/z ratios lie within the tolerance once a
mass shift is applied. The mass shift is simply the difference in
precursor-m/z between the two spectra.
See also matchms ModifiedCosine for more information.
NeutralLossesCosine(): The neutral losses cosine score aims at
quantifying the similarity between two mass spectra. The score is
calculated by finding the best possible matches between peaks of two
spectra. Two peaks are considered a potential match if their m/z ratios lie
within the given tolerance once a mass shift is applied. The mass shift
is the difference in precursor-m/z between the two spectra. See also
matchms NeutralLossesCosine for more information.
FingerprintSimilarity(): Calculate similarity between molecules based
on their fingerprints. For this similarity measure to work, fingerprints
are expected to be derived by running add_fingerprint(). See also
matchms FingerprintSimilarity for more information.

"><meta property="og:description" content="The compareSpectriPy() function allows to calculate spectral similarity
scores using the calculate_scores() function of the Python
matchms.similarity.
module.
Selection and configuration of the algorithm can be performed with one of the
parameter objects/functions:
CosineGreedy(): calculate the cosine similarity score between
spectra. The score is calculated by finding the best possible matches
between peaks of two spectra. Two peaks are considered a potential match if
their m/z ratios lie within the given tolerance. The underlying peak
assignment problem is here solved in a greedy way. This can perform
notably faster, but does occasionally deviate slightly from a fully correct
solution (as with the CosineHungarian algorithm). In practice this
will rarely affect similarity scores notably, in particular for smaller
tolerances. The algorithm can be configured with parameters tolerance,
mz_power and intensity_power (see parameter description for more
details). See also
matchms CosineGreedy for more information.
CosineHungarian(): calculate the cosine similarity score as with
CosineGreedy, but using the Hungarian algorithm to find the best
matching peaks between the compared spectra. The algorithm can be
configured with parameters tolerance, mz_power and intensity_power
(see parameter description for more details). See also
matchms CosingHungarian for more information.
ModifiedCosine(): The modified cosine score aims at quantifying the
similarity between two mass spectra. The score is calculated by finding
the best possible matches between peaks of two spectra. Two peaks are
considered a potential match if their m/z ratios lie within the given
tolerance, or if their m/z ratios lie within the tolerance once a
mass shift is applied. The mass shift is simply the difference in
precursor-m/z between the two spectra.
See also matchms ModifiedCosine for more information.
NeutralLossesCosine(): The neutral losses cosine score aims at
quantifying the similarity between two mass spectra. The score is
calculated by finding the best possible matches between peaks of two
spectra. Two peaks are considered a potential match if their m/z ratios lie
within the given tolerance once a mass shift is applied. The mass shift
is the difference in precursor-m/z between the two spectra. See also
matchms NeutralLossesCosine for more information.
FingerprintSimilarity(): Calculate similarity between molecules based
on their fingerprints. For this similarity measure to work, fingerprints
are expected to be derived by running add_fingerprint(). See also
matchms FingerprintSimilarity for more information.

"><meta property="og:image" content="https://rformassspectrometry.github.io/SpectriPy/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SpectriPy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SpectriPy.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/detailed-installation-configuration.html">Detailed information on installation and configuration</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/SpectriPy/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spectra similarity calculations using Python's matchms library</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/SpectriPy/blob/main/R/compareSpectriPy.R" class="external-link"><code>R/compareSpectriPy.R</code></a></small>
      <div class="d-none name"><code>compareSpectriPy.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>compareSpectriPy()</code> function allows to calculate spectral similarity
scores using the <code>calculate_scores()</code> function of the Python
<a href="https://matchms.readthedocs.io/en/latest/api/matchms.similarity.html" class="external-link">matchms.similarity</a>.
module.</p>
<p>Selection and configuration of the algorithm can be performed with one of the
<em>parameter</em> objects/functions:</p><ul><li><p><code>CosineGreedy()</code>: calculate the <em>cosine similarity score</em> between
spectra. The score is calculated by finding the best possible matches
between peaks of two spectra. Two peaks are considered a potential match if
their m/z ratios lie within the given <code>tolerance</code>. The underlying peak
assignment problem is here solved in a <em>greedy</em> way. This can perform
notably faster, but does occasionally deviate slightly from a fully correct
solution (as with the <code>CosineHungarian</code> algorithm). In practice this
will rarely affect similarity scores notably, in particular for smaller
tolerances. The algorithm can be configured with parameters <code>tolerance</code>,
<code>mz_power</code> and <code>intensity_power</code> (see parameter description for more
details). See also
<a href="https://matchms.readthedocs.io/en/latest/api/matchms.similarity.CosineGreedy.html" class="external-link">matchms CosineGreedy</a> for more information.</p></li>
<li><p><code>CosineHungarian()</code>: calculate the <em>cosine similarity score</em> as with
<code>CosineGreedy</code>, but using the Hungarian algorithm to find the best
matching peaks between the compared spectra. The algorithm can be
configured with parameters <code>tolerance</code>, <code>mz_power</code> and <code>intensity_power</code>
(see parameter description for more details). See also
<a href="https://matchms.readthedocs.io/en/latest/api/matchms.similarity.CosineHungarian.html" class="external-link">matchms CosingHungarian</a> for more information.</p></li>
<li><p><code>ModifiedCosine()</code>: The modified cosine score aims at quantifying the
similarity between two mass spectra. The score is calculated by finding
the best possible matches between peaks of two spectra. Two peaks are
considered a potential match if their m/z ratios lie within the given
<code>tolerance</code>, or if their m/z ratios lie within the tolerance once a
mass shift is applied. The mass shift is simply the difference in
precursor-m/z between the two spectra.
See also <a href="https://matchms.readthedocs.io/en/latest/api/matchms.similarity.ModifiedCosine.html" class="external-link">matchms ModifiedCosine</a> for more information.</p></li>
<li><p><code>NeutralLossesCosine()</code>: The neutral losses cosine score aims at
quantifying the similarity between two mass spectra. The score is
calculated by finding the best possible matches between peaks of two
spectra. Two peaks are considered a potential match if their m/z ratios lie
within the given <code>tolerance</code> once a mass shift is applied. The mass shift
is the difference in precursor-m/z between the two spectra. See also
<a href="https://matchms.readthedocs.io/en/latest/api/matchms.similarity.NeutralLossesCosine.html" class="external-link">matchms NeutralLossesCosine</a> for more information.</p></li>
<li><p><code>FingerprintSimilarity()</code>: Calculate similarity between molecules based
on their fingerprints. For this similarity measure to work, fingerprints
are expected to be derived by running <em>add_fingerprint()</em>. See also
<a href="https://matchms.readthedocs.io/en/latest/api/matchms.similarity.FingerprintSimilarity.html" class="external-link">matchms FingerprintSimilarity</a> for more information.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CosineGreedy</span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">0.1</span>, mz_power <span class="op">=</span> <span class="fl">0</span>, intensity_power <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CosineHungarian</span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">0.1</span>, mz_power <span class="op">=</span> <span class="fl">0</span>, intensity_power <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ModifiedCosine</span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">0.1</span>, mz_power <span class="op">=</span> <span class="fl">0</span>, intensity_power <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">NeutralLossesCosine</span><span class="op">(</span></span>
<span>  tolerance <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  mz_power <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  intensity_power <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ignore_peaks_above_precursor <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra,Spectra,CosineGreedy'</span></span>
<span><span class="fu">compareSpectriPy</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">param</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectra,missing,CosineGreedy'</span></span>
<span><span class="fu">compareSpectriPy</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">param</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tolerance">tolerance<a class="anchor" aria-label="anchor" href="#arg-tolerance"></a></dt>
<dd><p><code>numeric(1)</code>: tolerated differences in the peaks' m/z. Peaks
with m/z differences <code>&lt;= tolerance</code> are considered matching.</p></dd>


<dt id="arg-mz-power">mz_power<a class="anchor" aria-label="anchor" href="#arg-mz-power"></a></dt>
<dd><p><code>numeric(1)</code>: the power to raise m/z to in the cosine
function. The default is 0, in which case the peak intensity products will
not depend on the m/z ratios.</p></dd>


<dt id="arg-intensity-power">intensity_power<a class="anchor" aria-label="anchor" href="#arg-intensity-power"></a></dt>
<dd><p><code>numeric(1)</code>: the power to raise intensity to in the
cosine function. The default is 1.</p></dd>


<dt id="arg-ignore-peaks-above-precursor">ignore_peaks_above_precursor<a class="anchor" aria-label="anchor" href="#arg-ignore-peaks-above-precursor"></a></dt>
<dd><p>For <code>NeutralLossesCosine()</code>:
<code>logical(1)</code>: if <code>TRUE</code> (the default), peaks with m/z values larger than
the precursor m/z are ignored.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra::Spectra()</a></code> object.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra::Spectra()</a></code> object to compare against. If missing,
spectra similarities are calculated between all spectra in <code>x</code>.</p></dd>


<dt id="arg-param">param<a class="anchor" aria-label="anchor" href="#arg-param"></a></dt>
<dd><p>One of the parameter classes listed above (such as
<code>CosineGreedy</code>) defining the similarity scoring function in Python
and its parameters.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>compareSpectriPy()</code> Returns a <code>numeric</code> matrix with the scores,
with the number of rows equal to <code>length(x)</code> and the number of columns
equal to <code>length(y)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Parameters and algorithms are named as originally defined in the <em>matchms</em>
library (i.e. all parameters in <em>snake_case</em> while <em>CamelCase</em> is used
for the algorithms.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">Spectra::compareSpectra()</a></code> in the <em>Spectra</em> package for pure R
implementations of spectra similarity calculations.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Carolin Huber, Michael Witting, Johannes Rainer, Helge Hecht,
Marilyn De Graeve</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/Spectra" class="external-link">Spectra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Create some example Spectra.</span></span></span>
<span class="r-in"><span><span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">2L</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Caffeine"</span>, <span class="st">"Caffeine"</span>, <span class="st">"1-Methylhistidine"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    precursorMz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">195.0877</span>, <span class="fl">195.0877</span>, <span class="fl">170.0924</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DF</span><span class="op">$</span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">340.0</span>, <span class="fl">416</span>, <span class="fl">2580</span>, <span class="fl">412</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">388.0</span>, <span class="fl">3270</span>, <span class="fl">85</span>, <span class="fl">54</span>, <span class="fl">10111</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.407</span>, <span class="fl">47.494</span>, <span class="fl">3.094</span>, <span class="fl">100.0</span>, <span class="fl">13.240</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DF</span><span class="op">$</span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">135.0432</span>, <span class="fl">138.0632</span>, <span class="fl">163.0375</span>, <span class="fl">195.0880</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110.0710</span>, <span class="fl">138.0655</span>, <span class="fl">138.1057</span>, <span class="fl">138.1742</span>, <span class="fl">195.0864</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">109.2</span>, <span class="fl">124.2</span>, <span class="fl">124.5</span>, <span class="fl">170.16</span>, <span class="fl">170.52</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra</a></span><span class="op">(</span><span class="va">DF</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate pairwise similarity beween all spectra within sps with</span></span></span>
<span class="r-in"><span><span class="co">## matchms' CosineGreedy algorithm</span></span></span>
<span class="r-in"><span><span class="co">## Note: the first compareSpectriPy will take longer because the Python</span></span></span>
<span class="r-in"><span><span class="co">## environment needs to be set up.</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">compareSpectriPy</span><span class="op">(</span><span class="va">sps</span>, param <span class="op">=</span> <span class="fu">CosineGreedy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000000 0.1948181    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.1948181 1.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.0000000 0.0000000    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Next we calculate similarities for all spectra against the first one</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">compareSpectriPy</span><span class="op">(</span><span class="va">sps</span>, <span class="va">sps</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, param <span class="op">=</span> <span class="fu">CosineGreedy</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate pairwise similarity of all spectra in sps with matchms'</span></span></span>
<span class="r-in"><span><span class="co">## ModifiedCosine algorithm</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">compareSpectriPy</span><span class="op">(</span><span class="va">sps</span>, param <span class="op">=</span> <span class="fu">ModifiedCosine</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000000 0.1948181 0.1384183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.1948181 1.0000000 0.8520549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.1384183 0.8520549 1.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Note that the ModifiedCosine method requires the precursor m/z to be</span></span></span>
<span class="r-in"><span><span class="co">## known for all input spectra. Thus, it is advisable to remove spectra</span></span></span>
<span class="r-in"><span><span class="co">## without precursor m/z before using this algorithm.</span></span></span>
<span class="r-in"><span><span class="va">sps</span> <span class="op">&lt;-</span> <span class="va">sps</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">precursorMz</a></span><span class="op">(</span><span class="va">sps</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">compareSpectriPy</span><span class="op">(</span><span class="va">sps</span>, param <span class="op">=</span> <span class="fu">ModifiedCosine</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000000 0.1948181 0.1384183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.1948181 1.0000000 0.8520549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.1384183 0.8520549 1.0000000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Witting, Johannes Rainer, Carolin Huber, Marilyn De Graeve, Wout Bittremieux, Thomas Naake.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

